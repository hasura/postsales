
| Scenario                                                            | 1.3.3<br>                                                   | 2.11.9<br><br>(null collapse = true)                            | 2.11.11 (patch)<br><br>(null collapse = true)                   | 2.11.x<br><br>(null collapse = false)                   |
| ------------------------------------------------------------------- | ----------------------------------------------------------- | --------------------------------------------------------------- | --------------------------------------------------------------- | ------------------------------------------------------- |
| Update/Delete with a where clause that uses a non-nullable variable | NO RISK <br><br>Graphql validation prevents bulk updates    | RISK<br><br>Bug in GraphQL validation allowed bulk updates      | NO RISK<br><br>GraphQL validation prevents bulk updates.        | RISK<br><br>Hasura validation prevents bulk updates     |
| Update/Delete with a where clause that uses a nullable variable     | RISK<br><br>Bug in GraphQL validation allowed bulk updates. | RISK<br><br>Bug in GraphQL validation allowed bulk updates.<br> | RISK<br><br>Bug in GraphQL validation allowed bulk updates.<br> | NO RISK<br><br>Hasura validation prevents bulk updates. |

#### More Detailed Blog: https://hasura.io/blog/graphql-nulls-cheatsheet
#### Testing Method

Insert the following names into the table using the console:

- User1
- User
- User

Test queries and expected outcome:

  

|                                                                               |                                                                                                                                                                                                                                                        |                                                               |                                                                   |                                                                   |
| ----------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------- | ----------------------------------------------------------------- | ----------------------------------------------------------------- |
| Test case                                                                     | Query                                                                                                                                                                                                                                                  | Variables                                                     | Outcome in v1.3.3                                                 | Expected outcome in 2.11.11                                       |
| Read/query with a simple filter - non-nullable variable with a non-null value | query MyQuery($userid: bigint!) {<br><br>author(where: {id: {_eq: $userid}}) {<br><br>id<br><br>name<br><br>}<br><br>}                                                                                                                                 | {<br><br>"userid": 1<br><br>}                                 | Returns 1 row                                                     | Returns 1 row                                                     |
| Read/query with a simple filter - non-nullable variable with a null value     | query MyQuery($userid: bigint!) {<br><br>author(where: {id: {_eq: $userid}}) {<br><br>id<br><br>name<br><br>}<br><br>}                                                                                                                                 | {<br><br>"userid": null<br><br>}                              | Throws a validation error                                         | Throws a validation error                                         |
| Read/query with a simple filter - nullable variable with a non-null value     | query MyQuery($userid: bigint) {<br><br>author(where: {id: {_eq: $userid}}) {<br><br>id<br><br>name<br><br>}<br><br>}                                                                                                                                  | {<br><br>"userid": 1<br><br>}                                 | Returns 1 row                                                     | Returns 1 row                                                     |
| Read/query with a simple filter - nullable variable with a null value         | query MyQuery($userid: bigint) {<br><br>author(where: {id: {_eq: $userid}}) {<br><br>id<br><br>name<br><br>}<br><br>}                                                                                                                                  | {<br><br>"userid": null<br><br>}                              | Returns ALL rows                                                  | Returns ALL rows                                                  |
| Read/query with a compound filter - non-nullable variable with a null value   | query MyQuery($userid: bigint!, $username: String) {<br><br>author(where: {_and: {id: {_eq: $userid}, name: {_eq: $username}, }}) {<br><br>id<br><br>name<br><br>}<br><br>}                                                                            | {<br><br>"userid": null,<br><br>"username": "rajesh"<br><br>} | Throws a validation error                                         | Throws a validation error                                         |
| Read/query with a compound filter - nullable variable with a null value       | query MyQuery($userid: bigint, $username: String) {<br><br>author(where: {_and: {id: {_eq: $userid}, name: {_eq: $username}, }}) {<br><br>id<br><br>name<br><br>}<br><br>}                                                                             | {<br><br>"userid": null,<br><br>"username": "rajesh"<br><br>} | returns matching rows where non null conditions are true (2 rows) | returns matching rows where non null conditions are true (2 rows) |
| UpdateÂ  with a simple filter - non-nullable variable with a non-null value    | mutation simpleUpdateNonNullableVar($userid: bigint!) {<br><br>update_author(where: {id: {_eq: $userid}}, _set: {name: "rakesh"}) {<br><br>affected_rows<br><br>returning {<br><br>id<br><br>name<br><br>}<br><br>}<br><br>}                           | {<br><br>"userid": 1<br><br>}                                 | 1 row updated                                                     | 1 rows updated                                                    |
| Update with a simple filter - non-nullable variable with a null value         | mutation simpleUpdateNonNullableVar($userid: bigint!) {<br><br>update_author(where: {id: {_eq: $userid}}, _set: {name: "rakesh"}) {<br><br>affected_rows<br><br>returning {<br><br>id<br><br>name<br><br>}<br><br>}<br><br>}                           | {<br><br>"userid": null<br><br>}                              | Throws a validation error                                         | Throws a validation error                                         |
| Update with a simple filter - nullable variable with a non-null value         | mutation simpleUpdateNonNullableVar($userid: bigint) {<br><br>update_author(where: {id: {_eq: $userid}}, _set: {name: "rakesh"}) {<br><br>affected_rows<br><br>returning {<br><br>id<br><br>name<br><br>}<br><br>}<br><br>}                            | {<br><br>"userid": 1<br><br>}                                 | 1 row updated                                                     | 1 row updated                                                     |
| Update with a simple filter - nullable variable with a null value             | mutation simpleUpdateNonNullableVar($userid: bigint) {<br><br>update_author(where: {id: {_eq: $userid}}, _set: {name: "rakesh"}) {<br><br>affected_rows<br><br>returning {<br><br>id<br><br>name<br><br>}<br><br>}<br><br>}                            | {<br><br>"userid": null<br><br>}                              | update all rows                                                   | update all rows                                                   |
| Update with a compound filter - non-nullable variable with a null value       | mutation MyMutation($userid: bigint!, $name: String) {<br><br>update_author(where: {_and: {id: {_eq: $userid}, name: {_eq: $name}}}, _set: {name: "hello"}) {<br><br>affected_rows<br><br>returning {<br><br>id<br><br>name<br><br>}<br><br>}<br><br>} | {<br><br>"userid": null,<br><br>"name": "rajesh"<br><br>}     | Throws a validation error                                         | Throws a validation error                                         |
| Update with a compound filter - nullable variable with a null value           | mutation MyMutation($userid: bigint, $name: String) {<br><br>update_author(where: {_and: {id: {_eq: $userid}, name: {_eq: $name}}}, _set: {name: "hello"}) {<br><br>affected_rows<br><br>returning {<br><br>id<br><br>name<br><br>}<br><br>}<br><br>}  | {<br><br>"userid": null,<br><br>"name": "rajesh"<br><br>}     | returns matching rows where non null conditions are true (2 rows) | returns matching rows where non null conditions are true (2 rows) |



